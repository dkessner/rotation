<html>

<head>
<link rel="stylesheet" href="simple.css">
<link rel="stylesheet" href="custom.css">
</head>

<body>

<div class="header">
    <div class="header-logo">
        <img src="M.png"/>
    </div>
    <div class="header-text">
    <h1>Rotation Calendar Tool</h1>
    <p>
    Generate your own rotation calendar with custom event descriptions.
    </p>
    </div>
</div>

<style>
td {
    text-align: center;
}
</style>


<table>
<tr><td></td><td>Class</td><td>Location</td><td>Description</td><td>ID</td></tr>
<tr><td>B</td><td><input type="text" id="B" size="20%" /></td><td><input type="text" id="B_location" size="10%" /></td><td><input type="text" id="B_description" size="30%" /></td><td><input type="text" id="B_id" size="10%" /></td></tr>
<tr><td>C</td><td><input type="text" id="C" size="20%" /></td><td><input type="text" id="C_location" size="10%" /></td><td><input type="text" id="C_description" size="30%" /></td><td><input type="text" id="C_id" size="10%" /></td></tr>
<tr><td>D</td><td><input type="text" id="D" size="20%" /></td><td><input type="text" id="D_location" size="10%" /></td><td><input type="text" id="D_description" size="30%" /></td><td><input type="text" id="D_id" size="10%" /></td></tr>
<tr><td>E</td><td><input type="text" id="E" size="20%" /></td><td><input type="text" id="E_location" size="10%" /></td><td><input type="text" id="E_description" size="30%" /></td><td><input type="text" id="E_id" size="10%" /></td></tr>
<tr><td>F</td><td><input type="text" id="F" size="20%" /></td><td><input type="text" id="F_location" size="10%" /></td><td><input type="text" id="F_description" size="30%" /></td><td><input type="text" id="F_id" size="10%" /></td></tr>
<tr><td>G</td><td><input type="text" id="G" size="20%" /></td><td><input type="text" id="G_location" size="10%" /></td><td><input type="text" id="G_description" size="30%" /></td><td><input type="text" id="G_id" size="10%" /></td></tr>
<tr><td>H</td><td><input type="text" id="H" size="20%" /></td><td><input type="text" id="H_location" size="10%" /></td><td><input type="text" id="H_description" size="30%" /></td><td><input type="text" id="H_id" size="10%" /></td></tr>
<tr><td>I</td><td><input type="text" id="I" size="20%" /></td><td><input type="text" id="I_location" size="10%" /></td><td><input type="text" id="I_description" size="30%" /></td><td><input type="text" id="I_id" size="10%" /></td></tr>
</table>

<table>
<tr><td>Start Date</td><td><input type="date" name="start" id="startTime" value="2025-08-25"></td></tr>
<tr><td>End Date</td><td><input type="date" name="end" id="endTime" value="2026-06-15"></td></tr>
</table>

<input type="button" value="Generate calendar!" onclick="generateCalendar()">

<br/>
<hr/>
<br/>

<h3>Instructions</h3>

<article>
<ol>
    <li>Fill out the form.  Anything blank will be ignored.</li>
    <li>Click the <b>Generate calendar!</b> button to download <code>my_rotation.ics</code>
    <li>Import <code>my_rotation.ics</code> into your Google Calendar</li>
</ol>
</article>


<h3>Detailed instructions for importing the calendar</h3>

<h4>Create a new calendar (optional)</h4>

<ul>
    <li><i>Why?</i> Creating a new calendar lets you easily turn the calendar view
        on/off, and you can share it too.  You could create a calendar for each
        class/course.</li>
    <li><i>Why not?</i> Only events in your main calendar are visible to others for scheduling.</li>
    <li>Click the Settings icon, choose "Settings"</li>
    <li>(left sidebar) Click "Add calendar", "Create new calendar"</li>
    <li>Give your new calendar a name and click the "Create calendar" button
    </li>
</ul>


<h4>Import <code>my_rotation.ics</code></h4>

<ul>
<li>Go to (or stay in) the Settings page in Google Calendar</li> <li>(left sidebar) Click "Import & export", "Import"</li>
<li>Choose the calendar you want to add the events to, and select the
    <code>my_rotation.ics</code> file that you saved</li>
<li>Click "Import".</li>
</ul>

<h3>Advanced usage: multiple classes during the same period</h3>

<p>The second time you import, your new events will overwrite any
previously imported events occurring at the same time.  You can avoid
this by using the ID field in the form above.</p>

<p>You can put any text/numbers you want in the ID field.  Events
with different IDs will not overwrite each other.</p>

<p>For example, if you want to include 3 different classes occuring during
the same period on the same calendar, you could use three different ids:
1, 2, 3 to generate three <code>.ics</code> files to import into your
calendar.</p>


<h2>About</h2>

<p>
Thank you to <a href="https://www.marlborough.org/" target="_blank">Marlborough
School</a> for continuing to support equity and innovation in education.
</p>

<a href="https://www.marlborough.org/">
<div style="background-color:white; text-align:center; width:50%; margin: 0 auto;">
<img src="Mvision.jpg" width="70%">
</div>
</a>

<p>
Code license: <a href="https://opensource.org/licenses/MIT" target="_blank">MIT license</a>
</p>

<p>
Text license: Creative Commons Attribution-ShareAlike 4.0 International License
(<a href="https://creativecommons.org/licenses/by-sa/4.0" target="_blank">CC BY-SA 4.0</a>)
</p>

<p>
This project relies solely on open source software and tools.  You can find the
source code and more info here:
<a href="https://github.com/dkessner/rotation" target="_blank">GitHub repository</a>
</p>

<p>
To learn more about open source software, public data, and open educational
resources for teachers:  
<a href="https://dkessner.github.io/TeacherResources/" target="_blank">https://dkessner.github.io/TeacherResources/</a>
</p>

<p>
Questions?
Email <a href="mailto:Darren.Kessner@marlborough.org">Darren.Kessner@marlborough.org</a>
</p>


<script src="js/ics_transform_bundle.js"></script>

<script>


function download(filename, text) 
{
    let element = document.createElement('a');
    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
    element.setAttribute('download', filename);
    element.style.display = 'none';

    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
}


function generateCalendar() 
{
    let periods = ['B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'];
    let schedule = {};

    for (let period of periods)
    {
        let inputClass = document.getElementById(period);
        if (inputClass.value)
        {
            schedule[period] = {};
            schedule[period]["summary"] = inputClass.value;

            let inputLocation = document.getElementById(period + "_location");
            if (inputLocation)
                schedule[period]["location"] = inputLocation.value;

            let inputDescription = document.getElementById(period + "_description");
            if (inputDescription)
                schedule[period]["description"] = inputDescription.value;

            let inputID = document.getElementById(period + "_id");
            if (inputID)
                schedule[period]["uid_suffix"] = inputID.value;
        }
    }

    let startTime = document.getElementById("startTime").value;
    let endTime = document.getElementById("endTime").value;

    let ics = ics_transform.doTransformation(schedule, startTime, endTime);
    console.log(ics);

    download("my_rotation.ics", ics);
}

</script>

</body>
</html>


